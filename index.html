<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>MedStudyHub - Resumos e Flashcards de Medicina</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">
  <style>
    :root {
      --primary: #26a95c;
      --primary-dark: #166c36;
      --bg: #f7fafc;
      --content-bg: #fff;
      --card-bg: #fcfcfd;
      --card-bg-dark: #232a33;
      --section-bg: #f5f9fb;
      --shadow-main: 0 4px 32px 0 rgba(70,110,140,0.08);
      --shadow-card: 0 2px 24px rgba(80,120,140,0.09);
      --border-card: #ececec;
      --text-main: #213342;
      --text-secondary: #5c6874;
      --toast-bg: #26a95c;
      --fav: #26a95c;
      --danger: #b94141;
    }
    [data-theme="dark"] {
      --primary: #3be991;
      --primary-dark: #135b38;
      --bg: #181f28;
      --content-bg: #202833;
      --card-bg: #24313a;
      --card-bg-dark: #181f28;
      --section-bg: #233039;
      --shadow-main: 0 4px 36px 0 rgba(24,28,50,0.17);
      --shadow-card: 0 2px 18px rgba(34,54,74,0.13);
      --border-card: #2d3740;
      --text-main: #e5f9e9;
      --text-secondary: #97bfa8;
      --toast-bg: #3be991;
      --fav: #3be991;
      --danger: #e66c6c;
    }
    html, body { height:100%; margin:0; }
    body {
      font-family: 'Inter', system-ui, sans-serif;
      background: var(--bg);
      min-height: 100vh;
      margin: 0;
      transition: background .3s;
      color: var(--text-main);
      display: flex;
      flex-direction: column;
    }
    header {
      width: 100%;
      background: var(--content-bg);
      box-shadow: 0 3px 18px 0 rgba(100, 110, 140, 0.07);
      border-radius: 0 0 1rem 1rem;
      position: sticky;
      top: 0; z-index: 99;
      padding: 0.6rem 0;
      transition: background .3s;
    }
    .nav-main {
      display: flex;
      align-items: center;
      justify-content: space-between;
      max-width: 1200px;
      margin: 0 auto;
      gap: 1.5em;
      flex-wrap: wrap;
    }
    .nav-brand {
      font-weight: 700;
      font-size: 1.45em;
      letter-spacing: .01em;
      color: var(--primary-dark);
      text-decoration: none;
      padding-left: .5em;
    }
    .nav-links {
      display: flex;
      gap: 1.1em;
      align-items: center;
      flex-wrap: wrap;
    }
    .nav-links a {
      color: var(--text-secondary);
      font-weight: 500;
      padding: 0.1em 0.7em;
      border-radius: 0.5em;
      text-decoration: none;
      font-size: 1em;
      transition: background .18s;
    }
    .nav-links a:hover,
    .nav-links a:focus {
      background: var(--section-bg);
      color: var(--primary-dark);
    }
    .theme-toggle-btn {
      background: none;
      border: none;
      font-size: 1.5em;
      cursor: pointer;
      color: var(--primary);
      border-radius: 50%;
      padding: 0.2em 0.6em;
      transition: background 0.17s, color 0.17s;
      outline: none;
    }
    .theme-toggle-btn:hover, .theme-toggle-btn:focus {
      background: var(--section-bg);
      color: var(--primary-dark);
    }
    .container-main {
      display: grid;
      grid-template-columns: 1fr 390px;
      gap: 2.5em;
      max-width: 1280px;
      width: 100%;
      margin: 2.2em auto 1.5em auto;
      background: var(--content-bg);
      box-shadow: var(--shadow-main);
      border-radius: 1.5em;
      padding: 2.2em 2em 2.3em 2em;
      position: relative;
    }
    @media (max-width: 1050px) {
      .container-main { grid-template-columns: 1fr; gap:2em;}
      .sidebar { order:2; margin-top:2.2em;}
    }
    @media (max-width: 700px) {
      .container-main { padding:1.1em 0.5em; border-radius:0.6em;}
    }
    .main-content {
      width: 100%;
      min-width: 0;
      display: flex;
      flex-direction: column;
      gap: 2.5em;
    }
    .section-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(310px,1fr));
      gap: 2.2em;
      margin: 0 auto;
    }
    .card-md {
      background: var(--card-bg);
      border-radius: 1.2em;
      box-shadow: var(--shadow-card);
      border: 1.5px solid var(--border-card);
      display: flex;
      flex-direction: column;
      min-height: 285px;
      padding: 1.3em 1.3em 1em 1.3em;
      position: relative;
      transition: box-shadow .19s;
      overflow: hidden;
    }
    .card-md .fav-btn {
      position: absolute;
      top: 1.2em;
      right: 1em;
      background: none;
      border: none;
      font-size: 1.45em;
      color: #bbb;
      cursor: pointer;
      z-index: 2;
      transition: color .19s;
    }
    .card-md .fav-btn.fav { color: var(--fav); text-shadow: 0 2px 8px rgba(40,180,110,0.16);}
    .card-md hgroup h2 {
      color: var(--primary-dark);
      margin-bottom: .11em;
      font-size: 1.27em;
      line-height: 1.23;
    }
    .card-md hgroup h3 {
      color: var(--text-secondary);
      font-weight: 400;
      margin-top: 0;
      margin-bottom: .65em;
      opacity: .92;
    }
    .card-md img {
      max-height: 120px;
      object-fit: cover;
      border-radius: 0.9em;
      border: 1px solid var(--border-card);
      margin-bottom: .45em;
      width: 100%;
      aspect-ratio: 3/2;
      background: #f2f3f6;
      loading: lazy;
    }
    .card-md figure { margin:0 0 0.4em 0;}
    .card-md figure figcaption {
      text-align: right;
      font-size: 0.95em;
      opacity: 0.7;
      margin-bottom: .5em;
    }
    .card-md p { margin-top:.15em;}
    /* Sidebar */
    .sidebar {
      display: flex;
      flex-direction: column;
      gap: 2.3em;
      min-width: 0;
    }
    .search-box {
      background: var(--section-bg);
      border-radius: 1em;
      box-shadow: 0 1px 8px rgba(80,120,140,0.04);
      padding: 1.2em 1.3em 1em 1.3em;
      display: flex;
      flex-direction: column;
      gap: .7em;
      position: relative;
      z-index: 3;
    }
    .search-box input[type="search"] {
      width: 100%;
      padding: 0.7em 1em;
      border-radius: 1em;
      border: 1px solid #d8e2e7;
      background: #f7fafa;
      font-size: 1.03em;
    }
    .suggestion-box {
      background: var(--content-bg);
      border-radius: 1em;
      margin-top: .3em;
      box-shadow: 0 1px 8px rgba(80,120,140,0.08);
      max-width: 100%;
      position: absolute;
      left:0; right:0;
      font-size: 1em;
      display: none;
      z-index: 4;
    }
    .suggestion-box li {
      padding: .55em 1em;
      cursor: pointer;
      border-bottom: 1px solid #ececec;
      color: var(--text-main);
    }
    .suggestion-box li:last-child { border-bottom: none;}
    .suggestion-box li:hover { background: #e6f8e9; color: var(--primary);}
    /* Pomodoro */
    .pomodoro-widget {
      background: var(--section-bg);
      border-radius: 1.15em;
      box-shadow: 0 2px 18px rgba(80,120,140,0.08);
      padding: 1.8em 1.5em 1.7em 1.5em;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.35em;
      position: relative;
      min-width: 0;
    }
    .pomodoro-header {
      font-size: 1.18em;
      font-weight: 700;
      color: var(--primary-dark);
      letter-spacing: .01em;
    }
    .pomodoro-timer {
      font-size: 2.25em;
      font-weight: 700;
      color: var(--primary);
      letter-spacing: .03em;
      margin-bottom: .25em;
    }
    .pomodoro-status {
      font-size: 1em;
      color: var(--text-secondary);
      margin-bottom: 0.5em;
      font-weight: 600;
    }
    .pomodoro-controls {
      display: flex;
      gap: 0.8em;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 0.5em;
    }
    .pomodoro-controls button {
      background: var(--primary);
      color: #fff;
      border: none;
      border-radius: .5em;
      padding: .44em 1.1em;
      font-weight: 600;
      font-size: 1em;
      cursor: pointer;
      transition: background .17s;
      outline: none;
    }
    .pomodoro-controls button:disabled {
      background: #c1d8c3;
      color: #fff;
      cursor: not-allowed;
    }
    .pomodoro-controls button:hover:not(:disabled) {
      background: var(--primary-dark);
    }
    .pomodoro-settings {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: .6em;
      align-items: center;
      margin-bottom: 0.4em;
    }
    .pomodoro-settings label {
      font-size: .97em;
      color: var(--text-secondary);
      font-weight: 500;
      margin-right: .4em;
      margin-bottom: .1em;
    }
    .pomodoro-settings select, .pomodoro-settings input[type=number] {
      font-size: 1em;
      border-radius: .45em;
      padding: .18em .7em;
      margin-right: .8em;
      margin-bottom:.12em;
    }
    .pomodoro-cycles {
      margin-top: .3em;
      font-size: 0.97em;
      color: var(--text-secondary);
      letter-spacing: .01em;
      font-weight: 500;
    }
    /* Carrossel */
    .carousel-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 2.2rem;
      margin-bottom: 2.8rem;
      background: var(--section-bg);
      border-radius: 1.2rem;
      padding: 3.3rem 1rem 2rem 1rem;
      box-shadow: 0 2px 24px rgba(70,110,170,0.09);
      position: relative;
      overflow: visible;
      min-height: 380px;
      transition: background 0.3s;
      z-index: 10;
    }
    .carousel-title {
      text-align: center;
      margin-bottom: 1.2rem;
    }
    .carousel {
      position: relative;
      width: 340px;
      max-width: 100vw;
      height: 250px;
      display: flex;
      align-items: center;
      justify-content: center;
      perspective: 1100px;
      margin: 0 auto;
    }
    .carousel-card {
      width: 290px;
      min-height: 210px;
      background: var(--card-bg);
      border-radius: 1.1rem;
      box-shadow: var(--shadow-card);
      border: 1.5px solid var(--border-card);
      text-align: center;
      position: absolute;
      left: 0; right: 0;
      margin: 0 auto;
      opacity: 0;
      pointer-events: none;
      transform: scale(0.85) rotateY(30deg);
      transition: 
        opacity 0.38s cubic-bezier(.52,1.58,.57,.85),
        transform 0.45s cubic-bezier(.22,1.15,.6,1.01),
        background 0.38s;
      z-index: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding: 2.2rem 1.6rem 1.2rem 1.6rem;
      font-size: 1.08em;
      color: var(--text-main);
      will-change: transform, opacity;
    }
    .carousel-card.active {
      opacity: 1;
      pointer-events: all;
      transform: scale(1.04) rotateY(0);
      z-index: 2;
      box-shadow: 0 7px 36px rgba(32,90,110,0.24), 0 2px 16px rgba(80,210,180,0.07);
      animation: popIn .55s cubic-bezier(.39,1.45,.45,.95);
    }
    @keyframes popIn {
      0% { transform: scale(0.8) rotateY(25deg); opacity:0.2;}
      85% {transform: scale(1.07) rotateY(0);}
      100% { transform: scale(1.04) rotateY(0);}
    }
    .carousel-card:not(.active) {
      filter: blur(1.5px) brightness(0.94);
    }
    .carousel-card h4 {
      margin-bottom: 0.55em;
      color: var(--primary);
      font-size: 1.35em;
      font-weight: bold;
      letter-spacing: .02em;
    }
    .carousel-card p {
      color: var(--text-main);
      font-size: 1em;
      margin-bottom: 0;
      line-height: 1.5;
    }
    .carousel-nav {
      margin-top: 2.3em;
      display: flex;
      justify-content: center;
      gap: 1.3em;
      position: relative;
      z-index: 12;
    }
    .carousel-btn {
      background: var(--content-bg);
      border: 1.5px solid #d3e7db;
      color: var(--primary);
      border-radius: 50%;
      width: 44px; height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.6em;
      font-weight: bold;
      box-shadow: 0 2px 7px rgba(52,105,92,0.04);
      cursor: pointer;
      transition: 
        box-shadow 0.22s, 
        background 0.22s, 
        border 0.18s,
        color 0.15s;
      z-index: 13;
      position: relative;
    }
    .carousel-btn:hover,
    .carousel-btn:focus {
      background: var(--section-bg);
      color: var(--primary-dark);
      border-color: var(--primary);
      box-shadow: 0 4px 15px rgba(50,180,100,0.07);
      outline: none;
    }
    .carousel-indicators {
      display: flex;
      justify-content: center;
      gap: 0.7em;
      margin-top: 1.2em;
    }
    .carousel-dot {
      width: 11px; height: 11px;
      border-radius: 50%;
      background: #e0e0e0;
      transition: background 0.23s;
      cursor: pointer;
      border: 2px solid transparent;
    }
    .carousel-dot.active {
      background: var(--primary);
      border-color: var(--primary);
    }
    /* Toast */
    .toast {
      position: fixed;
      left: 50%;
      bottom: 3.2em;
      transform: translateX(-50%);
      background: var(--toast-bg);
      color: #fff;
      padding: .7em 1.3em;
      border-radius: 1.2em;
      font-size: 1.09em;
      box-shadow: 0 6px 22px rgba(60,130,90,0.08);
      opacity: 0;
      pointer-events: none;
      transition: opacity .25s, bottom .19s;
      z-index: 1000;
    }
    .toast.show {
      opacity: 1;
      bottom: 4.7em;
      pointer-events: all;
    }
    /* Newsletter & Footer */
    .newsletter-section {
      background: var(--section-bg);
      border-radius: 1.2em;
      box-shadow: 0 1px 8px rgba(80,120,140,0.04);
      margin: 2.2em auto 0 auto;
      max-width: 600px;
      padding: 1.5em 1em 1.6em 1em;
      text-align: center;
    }
    .newsletter-section form.grid { margin-top:1.1em;}
    footer {
      margin: 2.3em 0 0 0;
      text-align: center;
      color: var(--text-secondary);
      background: none;
      border: none;
      font-size: 1.03em;
      padding-bottom: .8em;
    }
    @media (max-width: 900px) {
      .carousel-section { min-height: 330px; padding:1.7em .2em 1.2em .2em; }
      .card-md { min-height: 225px; }
    }
    @media (max-width: 620px) {
      .section-grid { grid-template-columns:1fr; }
      .carousel, .carousel-card { width:99vw; max-width:99vw;}
      .newsletter-section { padding: 1em 0.5em;}
    }
  </style>
</head>
<body>
  <header>
    <div class="nav-main">
      <a href="#" class="nav-brand">MedStudyHub</a>
      <nav class="nav-links">
        <a href="#resumos">Resumos</a>
        <a href="#flashcards">Flashcards</a>
        <a href="#recursos">Recursos</a>
        <a href="#contato">Contato</a>
        <button id="themeToggleBtn" class="theme-toggle-btn" aria-label="Alternar modo claro/escuro" title="Alternar modo claro/escuro">🌙</button>
      </nav>
    </div>
  </header>
  <div class="container-main">
    <main class="main-content">
      <div class="section-grid" id="mainGrid">
        <section class="card-md" data-tags="organização estudos dicas">
          <button class="fav-btn" aria-label="Favoritar" title="Favoritar">&#9734;</button>
          <hgroup>
            <h2>Estude Medicina de Forma Organizada</h2>
            <h3>Resumos, flashcards e dicas criados por quem vive a rotina médica</h3>
          </hgroup>
          <img src="https://images.unsplash.com/photo-1503676382389-4809596d5290?auto=format&fit=crop&w=900&q=80" alt="Grupo de estudantes de medicina revisando juntos" class="hero-img" loading="lazy">
          <p>
            O MedStudyHub é sua plataforma para simplificar o aprendizado médico, com conteúdo revisado, flashcards interativos e recursos úteis para turbinar seus estudos e alcançar seus objetivos. Descubra como organizar seu tempo, aprofundar matérias-chave e estudar de maneira colaborativa.
          </p>
          <a href="#recursos" role="button" class="contrast" style="margin-top:.8em;">Quero começar</a>
        </section>
        <section class="card-md" data-tags="resumos diagramas visual">
          <button class="fav-btn" aria-label="Favoritar" title="Favoritar">&#9734;</button>
          <hgroup>
            <h2 id="resumos">Resumos Visuais</h2>
            <h3>Entenda de forma rápida e didática</h3>
          </hgroup>
          <figure>
            <img src="https://images.unsplash.com/photo-1515378791036-0648a3ef77b2?auto=format&fit=crop&w=900&q=80" alt="Caderno de medicina e canetas coloridas" loading="lazy">
            <figcaption>
              <a href="https://unsplash.com/photos/person-writing-on-white-paper-1515378791036-0648a3ef77b2" target="_blank">Unsplash</a>
            </figcaption>
          </figure>
          <p>
            Resumos organizados por assunto, diagramas, esquemas visuais e linguagem objetiva, preparados por estudantes e professores para facilitar sua revisão diária.
          </p>
        </section>
        <section class="card-md" data-tags="flashcards revisão">
          <button class="fav-btn" aria-label="Favoritar" title="Favoritar">&#9734;</button>
          <hgroup>
            <h2 id="flashcards">Flashcards Interativos</h2>
            <h3>Fixe conteúdo de forma ativa</h3>
          </hgroup>
          <figure>
            <img src="https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=900&q=80" alt="Cartões de estudo sobre uma mesa" loading="lazy">
            <figcaption>
              <a href="https://unsplash.com/photos/flashcards-on-desk-1464983953574-0892a716854b" target="_blank">Unsplash</a>
            </figcaption>
          </figure>
          <p>
            Revise conceitos essenciais com perguntas e respostas rápidas. Personalize seus próprios flashcards ou acesse os decks da comunidade para diferentes matérias do curso de Medicina.
          </p>
        </section>
        <section class="card-md" data-tags="dicas rotina saúde mental pomodoro">
          <button class="fav-btn" aria-label="Favoritar" title="Favoritar">&#9734;</button>
          <hgroup>
            <h2>Dicas de Estudo & Rotina</h2>
            <h3>Saúde mental e eficiência andam juntas</h3>
          </hgroup>
          <figure>
            <img src="https://images.unsplash.com/photo-1513258496099-48168024aec0?auto=format&fit=crop&w=900&q=80" alt="Café, caderno e tablet sobre a mesa de estudos" loading="lazy">
            <figcaption>
              <a href="https://unsplash.com/photos/study-tablet-1513258496099-48168024aec0" target="_blank">Unsplash</a>
            </figcaption>
          </figure>
          <p>
            Organize seu cronograma, aprenda a fazer pausas, use técnicas como pomodoro, e veja dicas de quem já passou pelos principais desafios do curso.
          </p>
        </section>
      </div>
      <section class="carousel-section" id="recursos">
        <div class="carousel-title">
          <hgroup>
            <h2>Recursos</h2>
            <h3>Para todas as fases do curso</h3>
          </hgroup>
        </div>
        <div class="carousel" id="resourceCarousel">
          <div class="carousel-card active" data-index="0">
            <h4>Gratuito</h4>
            <p>
              Acesso livre a resumos essenciais,<br>
              flashcards básicos e dicas de estudo.<br><br>
              <span style="font-size:0.93em;color:#5ab672;opacity:.98;">Ideal para quem está começando!</span>
            </p>
          </div>
          <div class="carousel-card" data-index="1">
            <h4>Premium</h4>
            <p>
              Conteúdo completo,<br>
              atualização semanal, materiais de revisão exclusivos<br>
              e suporte especializado.<br><br>
              <span style="font-size:0.93em;color:#298c56;opacity:.98;">Para quem quer ir além e se destacar!</span>
            </p>
          </div>
        </div>
        <div class="carousel-nav">
          <button class="carousel-btn" id="carouselPrev" aria-label="Anterior">&lt;</button>
          <button class="carousel-btn" id="carouselNext" aria-label="Próximo">&gt;</button>
        </div>
        <div class="carousel-indicators">
          <span class="carousel-dot active" data-index="0"></span>
          <span class="carousel-dot" data-index="1"></span>
        </div>
      </section>
    </main>
    <aside class="sidebar">
      <!-- BUSCA -->
      <div class="search-box">
        <label for="searchInput" style="font-weight:600;">Buscar Resumos/Flashcards</label>
        <input type="search" id="searchInput" placeholder="Digite um termo, matéria, etc">
        <ul class="suggestion-box" id="suggestionBox"></ul>
      </div>
      <!-- POMODORO NOVO -->
      <div class="pomodoro-widget" aria-label="Pomodoro Study Timer">
        <div class="pomodoro-header">Pomodoro</div>
        <div class="pomodoro-settings">
          <label>Foco: <input type="number" id="focusTime" min="10" max="60" value="25" style="width:3.3em;"> min</label>
          <label>Intervalo Curto: <input type="number" id="shortBreak" min="3" max="15" value="5" style="width:3.3em;"> min</label>
          <label>Intervalo Longo: <input type="number" id="longBreak" min="10" max="40" value="15" style="width:3.3em;"> min</label>
          <label>Ciclos para Intervalo Longo:
            <select id="cyclesToLongBreak">
              <option value="4">4</option>
              <option value="3">3</option>
              <option value="2">2</option>
              <option value="1">1</option>
            </select>
          </label>
        </div>
        <div class="pomodoro-timer" id="pomodoroLabel">25:00</div>
        <div class="pomodoro-status" id="pomodoroStatus">Foco</div>
        <div class="pomodoro-controls">
          <button id="pomodoroStart">Iniciar</button>
          <button id="pomodoroPause" disabled>Pausar</button>
          <button id="pomodoroReset">Resetar</button>
          <button id="pomodoroSkip">Pular</button>
        </div>
        <div class="pomodoro-cycles" id="pomodoroCycles">Ciclos completos: 0</div>
      </div>
    </aside>
  </div>
  <section class="newsletter-section">
    <hgroup>
      <h2>Receba Novidades e Conteúdos</h2>
      <h3>Assine e receba atualizações sobre materiais de estudo em medicina!</h3>
    </hgroup>
    <form class="grid">
      <input type="text" id="firstname" name="firstname" placeholder="Seu nome" aria-label="Seu nome" required>
      <input type="email" id="email" name="email" placeholder="Seu melhor e-mail" aria-label="Seu melhor e-mail" required>
      <button type="submit" onclick="event.preventDefault()">Quero Receber</button>
    </form>
  </section>
  <footer id="contato">
    <small>
      <a href="mailto:contato@medstudyhub.com.br">contato@medstudyhub.com.br</a> • 
      <a href="https://www.instagram.com/" target="_blank">Instagram</a>
    </small>
    <br>
    <small>&copy; 2025 MedStudyHub</small>
  </footer>
  <div class="toast" id="toastMsg"></div>
  <script>
    // --- Tema Escuro ---
    const themeToggleBtn = document.getElementById('themeToggleBtn');
    function getPrefTheme() {
      if (localStorage.getItem('theme')) return localStorage.getItem('theme');
      return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    }
    function applyTheme(theme) {
      document.documentElement.setAttribute('data-theme', theme);
      themeToggleBtn.innerText = theme === 'dark' ? '🌞' : '🌙';
      localStorage.setItem('theme', theme);
    }
    themeToggleBtn.addEventListener('click', () => {
      const currentTheme = document.documentElement.getAttribute('data-theme');
      applyTheme(currentTheme === 'dark' ? 'light' : 'dark');
    });
    applyTheme(getPrefTheme());

    // --- Favoritos localStorage ---
    function getFavs() {
      return JSON.parse(localStorage.getItem('med_favs') || "[]");
    }
    function saveFavs(favs) {
      localStorage.setItem('med_favs', JSON.stringify(favs));
    }
    function toggleFav(section, idx) {
      let favs = getFavs();
      if (favs.includes(idx)) {
        favs = favs.filter(i => i !== idx);
        section.querySelector('.fav-btn').classList.remove('fav');
        showToast('Removido dos favoritos');
      } else {
        favs.push(idx);
        section.querySelector('.fav-btn').classList.add('fav');
        showToast('Adicionado aos favoritos!');
      }
      saveFavs(favs);
    }
    document.querySelectorAll('.card-md').forEach((section, idx) => {
      const btn = section.querySelector('.fav-btn');
      btn.onclick = () => toggleFav(section, idx);
      if (getFavs().includes(idx)) btn.classList.add('fav');
    });

    // --- Busca instantânea + sugestões ---
    const searchInput = document.getElementById('searchInput');
    const suggestionBox = document.getElementById('suggestionBox');
    const sections = Array.from(document.querySelectorAll('.card-md'));
    const suggestionThemes = [
      "Cardiologia", "Anatomia", "Fisiologia", "Farmacologia",
      "Pediatria", "Ginecologia", "Clínica Médica", "Neurologia",
      "Psiquiatria", "Cirurgia Geral", "Endocrinologia", "Patologia"
    ];
    searchInput.addEventListener('input', () => {
      let v = searchInput.value.toLowerCase();
      sections.forEach(sec => {
        let tags = sec.getAttribute('data-tags') || "";
        let h2 = sec.querySelector('h2').innerText.toLowerCase();
        let h3 = sec.querySelector('h3').innerText.toLowerCase();
        let text = sec.innerText.toLowerCase();
        if (v === "" || tags.includes(v) || h2.includes(v) || h3.includes(v) || text.includes(v)) {
          sec.style.display = "";
        } else {
          sec.style.display = "none";
        }
      });
      let sug = suggestionThemes.filter(t => t.toLowerCase().startsWith(v) && v.length >= 2);
      suggestionBox.innerHTML = sug.map(t => `<li>${t}</li>`).join('');
      suggestionBox.style.display = sug.length ? "block" : "none";
      suggestionBox.querySelectorAll('li').forEach(li => {
        li.onclick = () => {
          searchInput.value = li.innerText;
          suggestionBox.style.display = "none";
          searchInput.dispatchEvent(new Event('input'));
        };
      });
    });
    document.addEventListener('click', e => {
      if (!suggestionBox.contains(e.target) && e.target !== searchInput) suggestionBox.style.display = "none";
    });

    // --- Pomodoro Avançado ---
    const pomodoroLabel = document.getElementById('pomodoroLabel');
    const pomodoroStatus = document.getElementById('pomodoroStatus');
    const pomodoroStart = document.getElementById('pomodoroStart');
    const pomodoroPause = document.getElementById('pomodoroPause');
    const pomodoroReset = document.getElementById('pomodoroReset');
    const pomodoroSkip = document.getElementById('pomodoroSkip');
    const focusTimeInput = document.getElementById('focusTime');
    const shortBreakInput = document.getElementById('shortBreak');
    const longBreakInput = document.getElementById('longBreak');
    const cyclesToLongBreakInput = document.getElementById('cyclesToLongBreak');
    const pomodoroCycles = document.getElementById('pomodoroCycles');
    let pomodoro = {
      state: 'focus', // focus, short, long
      timer: 25*60,
      interval: null,
      cycles: 0,
      cyclesToLong: 4,
      focusTime: 25*60,
      shortBreak: 5*60,
      longBreak: 15*60
    };
    function updatePomodoroSettings() {
      pomodoro.focusTime = Number(focusTimeInput.value) * 60;
      pomodoro.shortBreak = Number(shortBreakInput.value) * 60;
      pomodoro.longBreak = Number(longBreakInput.value) * 60;
      pomodoro.cyclesToLong = Number(cyclesToLongBreakInput.value);
      if (pomodoro.state === 'focus') pomodoro.timer = pomodoro.focusTime;
      else if (pomodoro.state === 'short') pomodoro.timer = pomodoro.shortBreak;
      else pomodoro.timer = pomodoro.longBreak;
      updatePomodoroDisplay();
    }
    [focusTimeInput, shortBreakInput, longBreakInput, cyclesToLongBreakInput].forEach(inp => {
      inp.addEventListener('change', updatePomodoroSettings);
    });
    function formatTime(secs) {
      let m = Math.floor(secs/60), s = secs%60;
      return `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
    }
    function updatePomodoroDisplay() {
      pomodoroLabel.innerText = formatTime(pomodoro.timer);
      if (pomodoro.state === 'focus') pomodoroStatus.innerText = "Foco";
      else if (pomodoro.state === 'short') pomodoroStatus.innerText = "Intervalo Curto";
      else pomodoroStatus.innerText = "Intervalo Longo";
      pomodoroCycles.innerText = "Ciclos completos: " + pomodoro.cycles;
    }
    function pomodoroTick() {
      if (pomodoro.timer > 0) {
        pomodoro.timer--;
        updatePomodoroDisplay();
      } else {
        clearInterval(pomodoro.interval); pomodoro.interval = null;
        if (pomodoro.state === 'focus') {
          pomodoro.cycles++;
          if (pomodoro.cycles % pomodoro.cyclesToLong === 0) {
            pomodoro.state = 'long';
            pomodoro.timer = pomodoro.longBreak;
            showToast("Hora do intervalo longo!");
          } else {
            pomodoro.state = 'short';
            pomodoro.timer = pomodoro.shortBreak;
            showToast("Hora do intervalo!");
          }
        } else {
          pomodoro.state = 'focus';
          pomodoro.timer = pomodoro.focusTime;
          showToast("Vamos voltar ao foco!");
        }
        updatePomodoroDisplay();
        setTimeout(() => pomodoroStartPomodoro(), 700); // auto start
      }
    }
    function pomodoroStartPomodoro() {
      if (pomodoro.interval) return;
      pomodoroStart.disabled = true;
      pomodoroPause.disabled = false;
      pomodoro.interval = setInterval(pomodoroTick, 1000);
    }
    function pomodoroPausePomodoro() {
      clearInterval(pomodoro.interval);
      pomodoro.interval = null;
      pomodoroStart.disabled = false;
      pomodoroPause.disabled = true;
    }
    function pomodoroResetPomodoro() {
      clearInterval(pomodoro.interval);
      pomodoro.interval = null;
      pomodoro.state = 'focus';
      pomodoro.cycles = 0;
      pomodoro.focusTime = Number(focusTimeInput.value) * 60;
      pomodoro.shortBreak = Number(shortBreakInput.value) * 60;
      pomodoro.longBreak = Number(longBreakInput.value) * 60;
      pomodoro.cyclesToLong = Number(cyclesToLongBreakInput.value);
      pomodoro.timer = pomodoro.focusTime;
      updatePomodoroDisplay();
      pomodoroStart.disabled = false;
      pomodoroPause.disabled = true;
    }
    function pomodoroSkipPomodoro() {
      clearInterval(pomodoro.interval); pomodoro.interval = null;
      if (pomodoro.state === 'focus') {
        pomodoro.cycles++;
        if (pomodoro.cycles % pomodoro.cyclesToLong === 0) {
          pomodoro.state = 'long';
          pomodoro.timer = pomodoro.longBreak;
        } else {
          pomodoro.state = 'short';
          pomodoro.timer = pomodoro.shortBreak;
        }
      } else {
        pomodoro.state = 'focus';
        pomodoro.timer = pomodoro.focusTime;
      }
      updatePomodoroDisplay();
      pomodoroStart.disabled = false;
      pomodoroPause.disabled = true;
    }
    pomodoroStart.onclick = pomodoroStartPomodoro;
    pomodoroPause.onclick = pomodoroPausePomodoro;
    pomodoroReset.onclick = pomodoroResetPomodoro;
    pomodoroSkip.onclick = pomodoroSkipPomodoro;
    updatePomodoroDisplay();
    pomodoroPause.disabled = true;

    // --- Toast notifications ---
    function showToast(msg) {
      const toast = document.getElementById('toastMsg');
      toast.innerText = msg;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 1800);
    }

    // --- Carrossel Recursos ---
    const cards = document.querySelectorAll('.carousel-card');
    const dots = document.querySelectorAll('.carousel-dot');
    let current = 0;
    function showCard(index) {
      cards.forEach((card, i) => card.classList.toggle('active', i === index));
      dots.forEach((dot, i) => dot.classList.toggle('active', i === index));
      current = index;
    }
    document.getElementById('carouselNext').onclick = () => showCard((current + 1) % cards.length);
    document.getElementById('carouselPrev').onclick = () => showCard((current - 1 + cards.length) % cards.length);
    dots.forEach(dot => dot.onclick = () => showCard(Number(dot.dataset.index)));
    let startX = null;
    document.getElementById('resourceCarousel').addEventListener('touchstart', e => { startX = e.touches[0].clientX; }, {passive:true});
    document.getElementById('resourceCarousel').addEventListener('touchend', e => {
      if (startX === null) return;
      let endX = e.changedTouches[0].clientX;
      if (endX - startX > 50) document.getElementById('carouselPrev').click();
      if (startX - endX > 50) document.getElementById('carouselNext').click();
      startX = null;
    });
  </script>
</body>
</html>
